local PATH = "tp_idx.txt"
local Vector3 = CS.UnityEngine.Vector3

local function show(msg)
  if CS and CS.MoleMole and CS.MoleMole.ActorUtils and CS.MoleMole.ActorUtils.ShowMessage then
    CS.MoleMole.ActorUtils.ShowMessage(tostring(msg))
  else
    print(tostring(msg))
  end
end
local function read_idx()
  local f = io.open(PATH, "r")
  if f then
    local s = f:read("*l")
    f:close()
    local n = tonumber(s)
    if n and n >= 1 and n <= #W then return n end
  end
  return 1
end
local W = {
  {name = "shady1", x = 2614.809326, y = 476.543213, z = 4041.682617},
  {name = "shady2", x = 2451.722900, y = 396.532440, z = 3471.772217},
  {name = "shady3", x = 2790.186035, y = 443.607574, z = 3330.488770},
  {name = "shady4", x = 2838.004150, y = 403.866302, z = 3346.812012},
  {name = "shady5", x = 2946.374023, y = 374.722229, z = 3338.775879},
  {name = "shady6", x = 2836.764160, y = 389.349762, z = 3609.022461},
  {name = "shady7", x = 2817.769287, y = 305.155914, z = 3598.826172},
  {name = "shady8", x = 3021.970947, y = 441.553345, z = 3595.364502},
  {name = "shady9", x = 2922.512695, y = 430.427551, z = 3676.848389},
  {name = "shady10", x = 2810.180176, y = 348.826355, z = 3732.963867},
  {name = "shady11", x = 2966.232178, y = 340.347046, z = 3654.313965},
  {name = "shady12", x = 2532.173340, y = 474.457397, z = 3883.631348},
  {name = "shady13", x = 3101.369385, y = 311.696045, z = 3704.608398},
  {name = "shady14", x = 2734.788330, y = 391.723297, z = 3788.895508},
  {name = "shady15", x = 3195.398193, y = 457.705811, z = 3464.046631},
  {name = "shady16", x = 3075.431641, y = 385.872894, z = 3085.702881},
  {name = "shady17", x = 3022.420898, y = 429.306610, z = 2940.477051},
  {name = "shady18", x = 3099.747314, y = 422.507965, z = 2974.363770},
  {name = "shady19", x = 2975.080566, y = 441.021454, z = 2986.382324},
  {name = "shady20", x = 2880.389160, y = 429.818207, z = 2981.247070},
  {name = "shady21", x = 2703.146729, y = 434.529724, z = 3035.161377},
  {name = "shady22", x = 2772.246338, y = 413.806885, z = 3098.053223},
  {name = "shady23", x = 2386.234863, y = 491.671783, z = 3952.241211},
  {name = "shady24", x = 3899.414062, y = 507.942596, z = 3633.623047},
  {name = "shady25", x = 3960.451904, y = 554.826172, z = 3732.164062},
  {name = "shady26", x = 3973.649658, y = 506.276672, z = 3562.896240},
  {name = "shady27", x = 2595.654297, y = 476.046417, z = 3734.824463},
  {name = "shady28", x = 2566.821777, y = 462.502136, z = 3615.966309},
  {name = "shady29", x = 3735.227295, y = 495.708313, z = 3545.065674},
  {name = "shady30", x = 3599.566406, y = 537.523621, z = 3441.749756},
  {name = "shady31", x = 3868.164307, y = 498.897003, z = 3516.581787},
  {name = "shady32", x = 4097.994629, y = 571.849915, z = 3275.442383},
  {name = "shady33", x = 3368.416016, y = 492.933136, z = 3387.217041},
  {name = "shady34", x = 2477.156982, y = 353.676331, z = 3687.059814},
  {name = "shady35", x = 3297.685791, y = 454.415863, z = 3529.878662},
  {name = "shady36", x = 3452.469727, y = 494.712006, z = 3269.709717},
  {name = "shady37", x = 3374.898682, y = 452.390869, z = 3210.571045},
  {name = "shady38", x = 3508.844482, y = 452.985138, z = 2927.542725},
  {name = "shady39", x = 3501.374756, y = 442.201752, z = 2929.714844},
  {name = "shady40", x = 3348.352539, y = 367.170410, z = 3021.889160},
  {name = "shady41", x = 3340.226318, y = 441.399536, z = 2895.731689},
  {name = "shady42", x = 3257.603516, y = 414.297821, z = 3091.252441},
  {name = "shady43", x = 3613.692627, y = 419.737274, z = 2728.645996},
  {name = "shady44", x = 3627.548828, y = 443.957367, z = 2814.568604},
  {name = "shady45", x = 2405.877686, y = 411.831085, z = 3707.759521},
  {name = "shady46", x = 3773.700928, y = 441.444244, z = 2759.593994},
  {name = "shady47", x = 3657.907471, y = 497.021118, z = 3158.758545},
  {name = "shady48", x = 3636.437744, y = 484.273560, z = 2986.794678},
  {name = "shady49", x = 3816.658691, y = 476.758972, z = 3002.956787},
  {name = "shady50", x = 3665.878174, y = 410.326447, z = 3093.980713},
  {name = "shady51", x = 3735.013184, y = 462.916595, z = 3228.530762},
  {name = "shady52", x = 3874.378418, y = 465.743866, z = 3114.931152},
  {name = "shady53", x = 2978.492432, y = 464.250397, z = 3303.138672},
  {name = "shady54", x = 2402.646973, y = 283.956268, z = 3467.132324},
  {name = "shady55", x = 2627.288330, y = 500.308105, z = 3654.700195},
  {name = "shady56", x = 2565.561279, y = 321.795258, z = 3584.691162},
  {name = "shady57", x = 2846.094238, y = 445.094025, z = 3196.191895},
  {name = "shady58", x = 2376.577637, y = 383.019073, z = 3950.318115},
  {name = "shady59", x = 2840.145996, y = 503.751740, z = 3378.024902},
  {name = "shady60", x = 2848.518066, y = 491.024231, z = 3262.710205},
  {name = "shady61", x = 2474.189453, y = 334.131653, z = 3590.708252},
  {name = "shady62", x = 2421.806641, y = 414.172424, z = 3417.269287},
  {name = "shady63", x = 2446.702393, y = 415.348145, z = 3408.407227},
  {name = "shady64", x = 2533.770508, y = 426.887360, z = 3441.069092},
  {name = "shady65", x = 2541.799805, y = 391.517395, z = 3502.565674},
  {name = "shady66", x = 2332.998047, y = 477.145020, z = 3474.070557},
  {name = "shady67", x = 2290.501221, y = 440.400299, z = 3549.745117},
  {name = "shady68", x = 2292.179688, y = 463.907623, z = 3400.434570},
  {name = "shady69", x = 2527.691895, y = 361.758575, z = 3699.805664},
  {name = "shady70", x = 2405.901611, y = 440.191315, z = 3359.844482},
  {name = "shady71", x = 2523.759277, y = 442.213623, z = 3145.333740},
  {name = "shady72", x = 2588.149658, y = 430.111694, z = 3193.220947},
  {name = "shady73", x = 2852.055908, y = 442.160400, z = 3338.049805},
  {name = "shady74", x = 2927.048096, y = 419.535248, z = 3580.847412},
  {name = "shady75", x = 2744.030029, y = 384.830292, z = 3524.949951},
  {name = "shady76", x = 2756.317139, y = 420.882965, z = 3495.841309},
  {name = "shady77", x = 2982.932373, y = 427.830048, z = 3653.260742},
  {name = "shady78", x = 2865.631104, y = 320.839203, z = 3658.298584},
  {name = "shady79", x = 2982.324951, y = 449.508331, z = 3906.636963},
  {name = "shady80", x = 2459.709229, y = 417.661621, z = 3736.280762},
  {name = "shady81", x = 2956.560547, y = 433.221954, z = 3773.936768},
  {name = "shady82", x = 2881.516846, y = 415.871490, z = 3813.943115},
  {name = "shady83", x = 2800.080566, y = 429.159668, z = 3892.591553},
  {name = "shady84", x = 2775.095215, y = 395.051544, z = 3817.938232},
  {name = "shady85", x = 3143.827393, y = 441.143372, z = 3468.792480},
  {name = "shady86", x = 3090.139404, y = 410.909363, z = 3462.345215},
  {name = "shady87", x = 3123.929199, y = 404.018646, z = 3341.275391},
  {name = "shady88", x = 3042.902588, y = 393.356934, z = 3143.595703},
  {name = "shady89", x = 2970.035645, y = 441.828125, z = 3196.510254},
  {name = "shady90", x = 3044.465088, y = 406.869324, z = 3032.953369},
  {name = "shady91", x = 2268.026123, y = 439.835968, z = 3694.146973},
  {name = "shady92", x = 2974.895996, y = 441.940186, z = 3077.505859},
  {name = "shady93", x = 2767.916260, y = 434.625824, z = 3004.881836},
  {name = "shady94", x = 3845.079102, y = 492.723755, z = 3583.273682},
  {name = "shady95", x = 3909.796875, y = 499.239624, z = 3591.458008},
  {name = "shady96", x = 3957.831543, y = 534.963257, z = 3660.813721},
  {name = "shady97", x = 3947.009277, y = 533.048584, z = 3690.467285},
  {name = "shady98", x = 3987.821533, y = 495.376526, z = 3517.143555},
  {name = "shady99", x = 3710.949219, y = 509.341217, z = 3508.437012},
  {name = "shady100", x = 3584.777832, y = 537.380798, z = 3451.656982},
  {name = "shady101", x = 3647.769043, y = 522.583374, z = 3445.212891},
  {name = "shady102", x = 2410.628662, y = 371.483765, z = 3593.491455},
  {name = "shady103", x = 3509.891602, y = 626.190002, z = 3403.438965},
  {name = "shady104", x = 3718.064453, y = 530.794189, z = 3409.080566},
  {name = "shady105", x = 3755.076660, y = 541.928467, z = 3393.244629},
  {name = "shady106", x = 3814.696533, y = 526.378052, z = 3449.319824},
  {name = "shady107", x = 3961.221191, y = 523.844543, z = 3291.237061},
  {name = "shady108", x = 4185.867676, y = 563.858154, z = 3315.167969},
  {name = "shady109", x = 3563.344971, y = 538.769287, z = 3477.539795},
  {name = "shady110", x = 3490.777344, y = 517.496094, z = 3497.992432},
  {name = "shady112", x = 3429.993652, y = 522.181519, z = 3447.891357},
  {name = "shady113", x = 3389.665283, y = 539.407288, z = 3471.057617},
  {name = "shady114", x = 2390.523682, y = 371.846313, z = 3620.132324},
  {name = "shady115", x = 3545.341797, y = 489.024933, z = 3259.455322},
  {name = "shady116", x = 3511.108887, y = 441.668701, z = 3341.735352},
  {name = "shady117", x = 3289.118164, y = 341.352417, z = 2752.960938},
  {name = "shady118", x = 3334.333496, y = 441.476715, z = 2770.846680},
  {name = "shady119", x = 3309.592529, y = 449.798035, z = 3105.026367},
  {name = "shady120", x = 3368.547607, y = 441.305634, z = 2958.227295},
  {name = "shady121", x = 3341.105713, y = 458.053467, z = 3025.570801},
  {name = "shady122", x = 3253.201172, y = 419.158203, z = 3052.543457},
  {name = "shady123", x = 3474.970947, y = 422.769348, z = 2781.774902},
  {name = "shady124", x = 3634.792725, y = 440.929199, z = 2845.373047},
  {name = "shady125", x = 2636.914795, y = 603.195801, z = 3660.220215},
  {name = "shady126", x = 3744.593506, y = 457.872131, z = 2822.834473},
  {name = "shady127", x = 3853.313965, y = 440.058838, z = 2778.234375},
  {name = "shady128", x = 3601.030762, y = 476.041473, z = 2889.059326},
  {name = "shady129", x = 3746.049316, y = 506.434601, z = 2983.209473},
  {name = "shady130", x = 3752.910645, y = 477.247467, z = 2899.412354},
  {name = "shady131", x = 3815.670654, y = 476.842163, z = 3004.341309},
  {name = "shady132", x = 3846.091553, y = 495.597534, z = 2972.517578},
  {name = "shady133", x = 3522.152344, y = 470.882416, z = 3167.342773},
  {name = "shady134", x = 3766.384033, y = 441.011719, z = 2950.400391},
  {name = "shady135", x = 2625.601074, y = 419.223541, z = 3809.951172},
  {name = "shady136", x = 2970.214600, y = 442.985535, z = 3422.670410},
  {name = "shady137", x = 2424.353271, y = 488.822906, z = 3897.757812},
  {name = "shady138", x = 3360.439941, y = 384.161438, z = 2997.382568},
  {name = "shady139", x = 2644.239014, y = 301.674652, z = 3724.944824},
  {name = "shady140", x = 2909.563721, y = 454.803802, z = 3429.886230},
  {name = "shady141", x = 2917.096924, y = 385.400177, z = 3344.319092},
  {name = "shady142", x = 2839.296143, y = 423.339966, z = 3806.864502},
  {name = "shady143", x = 2748.138672, y = 437.379639, z = 3903.848877},
  {name = "shady144", x = 2750.527588, y = 393.649780, z = 3811.086426},
  {name = "shady145", x = 3878.940674, y = 498.465790, z = 3470.391357},
  {name = "shady146", x = 3325.303467, y = 377.609772, z = 3000.340576},
  {name = "shady147", x = 2394.484131, y = 441.295532, z = 3803.818359},
  {name = "shady148", x = 2976.516357, y = 440.993347, z = 3529.659180},
  {name = "shady149", x = 2754.093262, y = 315.076080, z = 3554.875488},
  {name = "shady150", x = 3097.970703, y = 418.556122, z = 3123.225342},
  {name = "shady151", x = 4004.579102, y = 595.339722, z = 3603.289062},
  {name = "shady152", x = 3649.473389, y = 507.355011, z = 3520.214355},
  {name = "shady153", x = 3946.554443, y = 504.834290, z = 3399.878662},
  {name = "shady154", x = 3288.312988, y = 446.663727, z = 3233.662842},
  {name = "shady155", x = 3222.999756, y = 441.235931, z = 3186.655518},
  {name = "shady156", x = 3296.813965, y = 342.175842, z = 2744.810303},
  {name = "shady157", x = 3391.005615, y = 445.138519, z = 2820.437988},
  {name = "shady158", x = 2246.248779, y = 440.924072, z = 3727.900146},
  {name = "shady159", x = 3464.825195, y = 442.442719, z = 2948.250488},
  {name = "shady160", x = 3514.797363, y = 441.311707, z = 2847.791260},
  {name = "shady161", x = 3671.875977, y = 444.268433, z = 2791.015381},
  {name = "shady162", x = 3594.920410, y = 534.128113, z = 3219.679199},
  {name = "shady163", x = 4011.321289, y = 426.909546, z = 3183.451660},
  {name = "shady164", x = 3784.018311, y = 463.093018, z = 3227.389404},
  {name = "shady165", x = 3903.298340, y = 491.337158, z = 3221.743896},
  {name = "shady166", x = 2675.905518, y = 266.091095, z = 3565.271729},
  {name = "shady167", x = 2837.303711, y = 497.289246, z = 3333.546387},
  {name = "shady168", x = 2748.585449, y = 459.369690, z = 3224.203369},
  {name = "shady169", x = 2661.849121, y = 485.143677, z = 3369.076416},
  {name = "shady170", x = 2608.730957, y = 440.377838, z = 3422.302246},
  {name = "shady171", x = 2684.347412, y = 422.288910, z = 3535.769775},
  {name = "shady172", x = 2278.674072, y = 441.172821, z = 3335.778564},
}
local function read_idx()
  local f = io.open(PATH, "r")
  if f then
    local s = f:read("*l")
    f:close()
    local n = tonumber(s)
    if n and n >= 1 and n <= #W then return n end
  end
  return 1
end


local function write_idx(n)
  local f = io.open(PATH, "w")
  if f then f:write(tostring(n)); f:close() end
end


local idx = read_idx()
local wp  = W[idx]


local pos = Vector3(wp.x, wp.y, wp.z)
CS.MoleMole.ActorUtils.SetAvatarPos(pos)
show(string.format("TP %d/%d: %s (X:%.2f Y:%.2f Z:%.2f) [next-> %d]",
  idx, #W, wp.name, wp.x, wp.y, wp.z, (idx % #W) + 1))

idx = idx + 1
if idx > #W then idx = 1 end
write_idx(idx)
