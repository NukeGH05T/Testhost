-- STEP TELEPORT (файловый счётчик) — 1 клик = следующий поинт
-- Индекс сохраняется в файле рядом с игрой
local PATH = "geo_tp_idx.txt"

-- Алиас
local Vector3 = CS.UnityEngine.Vector3

-- Сообщение на экран / консоль
local function show(msg)
  if CS and CS.MoleMole and CS.MoleMole.ActorUtils and CS.MoleMole.ActorUtils.ShowMessage then
    CS.MoleMole.ActorUtils.ShowMessage(tostring(msg))
  else
    print(tostring(msg))
  end
end

-- === СПИСОК ГЕОКУЛОВ (131 точка) ===
local W = {
  {name="Point 1",  x=1237.5400390625, y=352.0350036621094, z=1588.8509521484375},
  {name="Point 2",  x=-875.427978515625, y=218.00799560546875, z=1270.4100341796875},
  {name="Point 3",  x=1218.3919677734375, y=202.24899291992188, z=-136.95599365234375},
  {name="Point 4",  x=949.614013671875, y=279.9620056152344, z=-235.0279998779297},
  {name="Point 5",  x=846.1539916992188, y=290.02801513671875, z=-240.25399780273438},
  {name="Point 6",  x=883.5469970703125, y=247.6230010986328, z=-142.64500427246094},
  {name="Point 7",  x=823.3510131835938, y=218.89199829101563, z=-84.71299743652344},
  {name="Point 8",  x=749.6179809570313, y=286.74700927734375, z=-77.85900115966797},
  {name="Point 9",  x=896.7100219726563, y=288.1470031738281, z=338.0920104980469},
  {name="Point 10", x=901.7009887695313, y=243.19500732421875, z=365.5039978027344},
  {name="Point 11", x=830.0880126953125, y=204.47300720214844, z=272.9360046386719},
  {name="Point 12", x=656.7990112304688, y=202.51100158691406, z=21.888999938964844},
  {name="Point 13", x=-651.7160034179688, y=237.28700256347656, z=1280.2950439453125},
  {name="Point 14", x=957.9409790039063, y=352.44000244140625, z=1748.487060546875},
  {name="Point 15", x=538.8839721679688, y=204.25, z=69.61900329589844},
  {name="Point 16", x=570.5919799804688, y=235.80599975585938, z=-222.58599853515625},
  {name="Point 17", x=595.0650024414063, y=304.0220031738281, z=-272.4800109863281},
  {name="Point 18", x=739.1580200195313, y=254.36900329589844, z=-285.3269958496094},
  {name="Point 19", x=675.4459838867188, y=246.7239990234375, z=-452.45098876953125},
  {name="Point 20", x=622.8469848632813, y=226.79200744628906, z=-503.1889953613281},
  {name="Point 21", x=398.5050048828125, y=217.26699829101563, z=-760.2630004882813},
  {name="Point 22", x=482.239013671875, y=204.5540008544922, z=-454.7760009765625},
  {name="Point 23", x=457.135986328125, y=259.7250061035156, z=-418.5589904785156},
  {name="Point 24", x=-513.625, y=249.3350067138672, z=1282.29296875},
  {name="Point 25", x=370.8160095214844, y=220.1490020751953, z=-192.5760040283203},
  {name="Point 26", x=773.2379760742188, y=306.48699951171875, z=1848.4150390625},
  {name="Point 27", x=273.9289855957031, y=207.1529998779297, z=-107.25499725341797},
  {name="Point 28", x=332.9729919433594, y=234.98500061035156, z=214.06700134277344},
  {name="Point 29", x=275.25799560546875, y=215.87100219726563, z=212.781005859375},
  {name="Point 30", x=237.0070037841797, y=261.6969909667969, z=136.9720001220703},
  {name="Point 31", x=29.400999069213867, y=285.62799072265625, z=221.656005859375},
  {name="Point 32", x=-61.2400016784668, y=275.0220031738281, z=-28.520000457763672},
  {name="Point 33", x=52.63600158691406, y=204.39500427246094, z=-154.02499389648438},
  {name="Point 34", x=-123.9520034790039, y=204.5070037841797, z=-568.010986328125},
  {name="Point 35", x=675.7349853515625, y=381.5780029296875, z=1789.9219970703125},
  {name="Point 36", x=-105.74600219726563, y=242.99099731445313, z=-905.6699829101563},
  {name="Point 37", x=-212.14100646972656, y=318.8190002441406, z=-1016.781005859375},
  {name="Point 38", x=-546.2990112304688, y=184.43099975585938, z=1095.85302734375},
  {name="Point 39", x=-344.35101318359375, y=239.13999938964844, z=1149.3160400390625},
  {name="Point 40", x=-250.60800170898438, y=268.1390075683594, z=1238.6080322265625},
  {name="Point 41", x=-158.20799255371094, y=220.322998046875, z=1037.2340087890625},
  {name="Point 42", x=-171.8979949951172, y=163.59800720214844, z=946.031982421875},
  {name="Point 43", x=-159.5019989013672, y=206.30099487304688, z=896.4199829101563},
  {name="Point 44", x=663.1500244140625, y=443.0669860839844, z=1844.0489501953125},
  {name="Point 45", x=-497.5740051269531, y=186.8780059814453, z=879.5390014648438},
  {name="Point 46", x=-582.5070190429688, y=263.07501220703125, z=697.6489868164063},
  {name="Point 47", x=-428.69500732421875, y=274.96099853515625, z=638.958984375},
  {name="Point 48", x=-515.2360229492188, y=368.0150146484375, z=614.1790161132813},
  {name="Point 49", x=746.3250122070313, y=324.864990234375, z=1753.1529541015625},
  {name="Point 50", x=-407.4330139160156, y=425.89300537109375, z=590.4359741210938},
  {name="Point 51", x=-215.5, y=429.90899658203125, z=464.6000061035156},
  {name="Point 52", x=-172.89999389648438, y=510.8110046386719, z=335.20001220703125},
  {name="Point 53", x=-122.94200134277344, y=309.37701416015625, z=245.77499389648438},
  {name="Point 54", x=126.2020034790039, y=294.9200134277344, z=333.7349853515625},
  {name="Point 55", x=-399.1029968261719, y=270.9739990234375, z=-1139.239013671875},
  {name="Point 56", x=279.0150146484375, y=228.28199768066406, z=465.2560119628906},
  {name="Point 57", x=452.9490051269531, y=231.4199981689453, z=476.54901123046875},
  {name="Point 58", x=109.12200164794922, y=209.72300720214844, z=724.802978515625},
  {name="Point 59", x=337.1099853515625, y=312.7720031738281, z=727.9609985351563},
  {name="Point 60", x=404.4339904785156, y=208.51800537109375, z=814.0800170898438},
  {name="Point 61", x=720.4840087890625, y=320.2749938964844, z=1682.6400146484375},
  {name="Point 62", x=638.8900146484375, y=226.9250030517578, z=867.5029907226563},
  {name="Point 63", x=770.7470092773438, y=268.0220031738281, z=943.3809814453125},
  {name="Point 64", x=719.343017578125, y=238.58299255371094, z=1660.541015625},
  {name="Point 65", x=624.0130004882813, y=280.9309997558594, z=1390.217041015625},
  {name="Point 66", x=-347.156005859375, y=257.4939880371094, z=-740.2990112304688},
  {name="Point 67", x=156.2100067138672, y=239.3520050048828, z=1433.2320556640625},
  {name="Point 68", x=290.4809875488281, y=203.53199768066406, z=1448.323974609375},
  {name="Point 69", x=562.9439697265625, y=192.2239990234375, z=1171.81396484375},
  {name="Point 70", x=639.385009765625, y=303.885986328125, z=1070.803955078125},
  {name="Point 71", x=1104.7919921875, y=238.3719940185547, z=1639.0789794921875},
  {name="Point 72", x=649.4530029296875, y=207.4980010986328, z=1257.9639892578125},
  {name="Point 73", x=733.2999877929688, y=156.56300354003906, z=1210.988037109375},
  {name="Point 74", x=732.2219848632813, y=134.02000427246094, z=1292.3399658203125},
  {name="Point 75", x=747.81298828125, y=224.44400024414063, z=1308.634033203125},
  {name="Point 76", x=947.5189819335938, y=277.76300048828125, z=1232.052978515625},
  {name="Point 77", x=-635.5070190429688, y=227.73800659179688, z=-163.11500549316406},
  {name="Point 78", x=987.8419799804688, y=270.8970031738281, z=1319.4739990234375},
  {name="Point 79", x=1016.1060180664063, y=365.2229919433594, z=1201.3759765625},
  {name="Point 80", x=1149.738037109375, y=219.82400512695313, z=905.5349731445313},
  {name="Point 81", x=1219.48095703125, y=304.3030090332031, z=1294.717041015625},
  {name="Point 82", x=1442.9310302734375, y=256.5450134277344, z=1296.5009765625},
  {name="Point 83", x=982.7000122070313, y=301.0840148925781, z=1619.0},
  {name="Point 84", x=1393.947998046875, y=234.25, z=1245.3299560546875},
  {name="Point 85", x=1344.4560546875, y=211.3979949951172, z=953.073974609375},
  {name="Point 86", x=1404.1689453125, y=213.18299865722656, z=1021.302001953125},
  {name="Point 87", x=1607.10302734375, y=207.99600219726563, z=1143.02197265625},
  {name="Point 88", x=-753.4879760742188, y=219.57200622558594, z=509.9219970703125},
  {name="Point 89", x=1611.7559814453125, y=205.7689971923828, z=892.4119873046875},
  {name="Point 90", x=1741.571044921875, y=230.56100463867188, z=873.801025390625},
  {name="Point 91", x=1892.760009765625, y=207.08599853515625, z=829.572998046875},
  {name="Point 92", x=1965.487060546875, y=216.80499267578125, z=853.5889892578125},
  {name="Point 93", x=2128.867919921875, y=192.73699951171875, z=744.155029296875},
  {name="Point 94", x=1946.2340087890625, y=253.89500427246094, z=621.6950073242188},
  {name="Point 95", x=950.2540283203125, y=396.2590026855469, z=1646.6490478515625},
  {name="Point 96", x=1851.7659912109375, y=214.0, z=726.3270263671875},
  {name="Point 97", x=1780.6729736328125, y=233.02200317382813, z=683.5689697265625},
  {name="Point 98", x=1706.7939453125, y=245.18499755859375, z=764.5910034179688},
  {name="Point 99", x=-677.8330078125, y=283.9580078125, z=549.6890258789063},
  {name="Point 100", x=1511.9649658203125, y=214.68899536132813, z=786.3660278320313},
  {name="Point 101", x=1537.2659912109375, y=248.33900451660156, z=750.197021484375},
  {name="Point 102", x=1594.302978515625, y=326.47601318359375, z=607.0289916992188},
  {name="Point 103", x=1718.2939453125, y=263.77899169921875, z=580.4340209960938},
  {name="Point 104", x=1793.27001953125, y=241.57000732421875, z=542.5750122070313},
  {name="Point 105", x=1830.010986328125, y=248.5290069580078, z=461.57501220703125},
  {name="Point 106", x=1677.5419921875, y=415.3380126953125, z=518.1530151367188},
  {name="Point 107", x=838.6309814453125, y=544.3809814453125, z=1426.26904296875},
  {name="Point 108", x=1685.177001953125, y=307.947998046875, z=431.2099914550781},
  {name="Point 109", x=1551.56396484375, y=282.0870056152344, z=367.5369873046875},
  {name="Point 110", x=-843.177001953125, y=202.91200256347656, z=786.1799926757813},
  {name="Point 111", x=1477.405029296875, y=245.8300018310547, z=453.5669860839844},
  {name="Point 112", x=1409.5999755859375, y=222.23300170898438, z=467.70001220703125},
  {name="Point 113", x=1509.06298828125, y=225.00999450683594, z=586.0549926757813},
  {name="Point 114", x=1453.949951171875, y=217.9949951171875, z=626.6599731445313},
  {name="Point 115", x=1357.3289794921875, y=221.96800231933594, z=642.39599609375},
  {name="Point 116", x=1139.2889404296875, y=205.1269989013672, z=578.9650268554688},
  {name="Point 117", x=889.3319702148438, y=212.36099243164063, z=541.2639770507813},
  {name="Point 118", x=831.7069702148438, y=213.2790069580078, z=655.5969848632813},
  {name="Point 119", x=885.5969848632813, y=334.04901123046875, z=1535.031005859375},
  {name="Point 120", x=740.1810302734375, y=229.40899658203125, z=680.1929931640625},
  {name="Point 121", x=-841.0460205078125, y=198.55299377441406, z=937.5499877929688},
  {name="Point 122", x=770.4450073242188, y=212.7100067138672, z=513.2650146484375},
  {name="Point 123", x=1069.987060546875, y=239.67999267578125, z=428.35101318359375},
  {name="Point 124", x=1237.2010498046875, y=210.27699279785156, z=353.20599365234375},
  {name="Point 125", x=1303.89697265625, y=211.31900024414063, z=447.0},
  {name="Point 126", x=1366.4630126953125, y=209.76400756835938, z=299.02899169921875},
  {name="Point 127", x=1436.7159423828125, y=198.98399353027344, z=371.0719909667969},
  {name="Point 128", x=1576.7969970703125, y=237.15899658203125, z=195.78399658203125},
  {name="Point 129", x=1277.85302734375, y=210.54100036621094, z=202.5290069580078},
  {name="Point 130", x=946.0339965820313, y=229.0030059814453, z=162.60000610351563},
  {name="Point 131", x=891.1790161132813, y=317.7560119628906, z=1610.1219482421875},
}

-- читаем индекс
local function read_idx()
  local f = io.open(PATH, "r")
  if f then
    local s = f:read("*l")
    f:close()
    local n = tonumber(s)
    if n and n >= 1 and n <= #W then return n end
  end
  return 1
end

-- пишем индекс
local function write_idx(n)
  local f = io.open(PATH, "w")
  if f then f:write(tostring(n)); f:close() end
end

-- основной шаг
local idx = read_idx()
local wp  = W[idx]

-- телепорт
local pos = Vector3(wp.x, wp.y, wp.z)
CS.MoleMole.ActorUtils.SetAvatarPos(pos)
show(string.format("TP %d/%d: %s (X:%.2f Y:%.2f Z:%.2f) [next-> %d]",
  idx, #W, wp.name, wp.x, wp.y, wp.z, (idx % #W) + 1))

-- следующий индекс (циклично)
idx = idx + 1
if idx > #W then idx = 1 end
write_idx(idx)
