local PATH = "tp_idx.txt"
local Vector3 = CS.UnityEngine.Vector3

local function show(msg)
  if CS and CS.MoleMole and CS.MoleMole.ActorUtils and CS.MoleMole.ActorUtils.ShowMessage then
    CS.MoleMole.ActorUtils.ShowMessage(tostring(msg))
  else
    print(tostring(msg))
  end
end

-- 替换tp坐标 --
local W = {
  {name="1",  x=-340.06, y=158.34, z=6074.12},
  {name="2",  x=-82.05, y=263.23, z=6036.47},
  {name="3",  x=141.15, y=260.96, z=6127.79},
  {name="4",  x=366.30, y=233.37, z=6188.53},
  {name="5",  x=393.63, y=337.16, z=6237.04},
  {name="6",  x=264.68, y=319.71, z=6374.63},
  {name="7",  x=339.45, y=293.27, z=6444.58},
  {name="8",  x=546.06, y=310.06, z=6355.84},
  {name="9",  x=487.82, y=216.95, z=6453.26},
  {name="10",  x=206.53, y=259.47, z=6751.44},
  {name="11",  x=362.28, y=358.79, z=6897.23},
  {name="12",  x=559.85, y=398.42, z=6916.58},
  {name="13",  x=617.83, y=404.95, z=6611.14},
  {name="14",  x=625.68, y=383.53, z=6534.43},
  {name="15",  x=1131.63, y=212.81, z=6496.28},
  {name="16",  x=561.04, y=351.18, z=6072.23},
  {name="17",  x=638.36, y=347.09, z=5864.32},
  {name="18",  x=486.79, y=378.73, z=5790.74},
  {name="19",  x=423.51, y=323.11, z=5780.17},
  {name="20",  x=493.62, y=423.41, z=5933.52},
  {name="21",  x=644.32, y=339.19, z=5583.07},
  {name="22",  x=783.24, y=335.76, z=5512.41},
  {name="23",  x=889.93, y=288.27, z=5566.50},
  {name="24",  x=836.63, y=326.10, z=5797.47},
  {name="25",  x=908.19, y=362.72, z=5853.34},
  {name="26",  x=940.89, y=432.62, z=5904.63},
  {name="27",  x=1036.15, y=465.47, z=6029.98},
  {name="28",  x=677.29, y=199.82, z=6676.78},
  {name="30",  x=770.25, y=248.00, z=6154.85},
  {name="31",  x=894.18, y=129.79, z=6474.73},
  {name="32",  x=1086.09, y=124.71, z=6526.47},
  {name="33",  x=455.38, y=115.02, z=6435.61},
  {name="34",  x=552.98, y=148.53, z=6275.68},
  {name="35",  x=400.55, y=148.55, z=6280.06},
  {name="36",  x=465.14, y=98.72, z=6331.11},
  {name="39",  x=764.13, y=221.08, z=6504.12},
  {name="c1",  x=449.00, y=246.15, z=2233.67},
  {name="c2",  x=406.78, y=263.58, z=2374.47},
  {name="c3",  x=338.00, y=287.04, z=2273.26},
  {name="c4",  x=208.42, y=264.00, z=2224.49},
  {name="c5",  x=164.20, y=428.40, z=2135.30},
  {name="c6",  x=40.48, y=468.46, z=2058.96},
  {name="c7",  x=-198.52, y=307.35, z=2129.06},
  {name="c8",  x=38.01, y=261.56, z=2250.44},
  {name="c9",  x=151.86, y=253.09, z=2392.32},
  {name="c10",  x=95.03, y=245.44, z=2654.97},
  {name="c11",  x=-300.42, y=166.16, z=2514.10},
  {name="c12",  x=-86.96, y=279.93, z=2333.20},
  {name="c13",  x=-748.39, y=156.59, z=2282.94},
  {name="c14",  x=-795.33, y=167.71, z=2375.94},
  {name="c15",  x=-819.89, y=228.12, z=2497.66},
  {name="c16",  x=-1096.00, y=282.49, z=2024.85},
  {name="c17",  x=-1287.22, y=344.01, z=1994.73},
  {name="c18",  x=-1728.95, y=221.05, z=2095.53},
  {name="c19",  x=-1488.10, y=359.21, z=2048.20},
  {name="c20",  x=-1494.72, y=241.76, z=2358.24},
  {name="c21",  x=-1566.62, y=532.66, z=2154.80},
  {name="c22",  x=-1860.34, y=234.78, z=2342.50},
  {name="c23",  x=-1952.18, y=214.06, z=2881.84},
  {name="c24",  x=-1707.16, y=203.65, z=2609.26},
  {name="c25",  x=-1703.24, y=236.87, z=2720.34},
  {name="c26",  x=-1636.86, y=202.92, z=2546.95},
  {name="c27",  x=-1370.29, y=307.46, z=2184.49},
  {name="c28",  x=-717.35, y=207.16, z=2741.12},
  {name="c29",  x=-1101.00, y=158.10, z=2196.00},
  {name="c30",  x=-1357.41, y=163.22, z=2368.74},
  {name="c31",  x=-1559.35, y=222.00, z=2436.28},
  {name="c32",  x=-1480.09, y=234.67, z=2571.40},
  {name="c33",  x=-1470.37, y=215.64, z=2467.91},
  {name="c34",  x=-1219.69, y=347.18, z=2452.80},
  {name="c35",  x=-1074.96, y=220.03, z=2312.76},
  {name="c36",  x=-1018.61, y=247.71, z=2515.74},
  {name="c37",  x=-856.55, y=214.88, z=2594.87},
  {name="c38",  x=-1194.61, y=216.52, z=2589.78},
  {name="c39",  x=-1227.82, y=266.74, z=2675.33},
  {name="c40",  x=-1647.98, y=239.01, z=2876.75},
  {name="c41",  x=-1328.66, y=294.63, z=2866.86},
  {name="c42",  x=-636.91, y=207.93, z=2726.96},
  {name="c43",  x=-108.25, y=248.66, z=2711.84},
  {name="c44",  x=85.99, y=224.71, z=2990.10},
  {name="c45",  x=-821.33, y=217.87, z=2957.00},
  {name="c46",  x=-71.39, y=197.44, z=2812.28},
  {name="c47",  x=-410.94, y=256.04, z=2958.45},
  {name="c48",  x=-48.65, y=186.92, z=2866.42},
  {name="c49",  x=-369.48, y=446.69, z=2941.97},
  {name="c50",  x=-17.15, y=375.98, z=2991.15},
  {name="c51",  x=-635.62, y=246.29, z=3001.68},
  {name="c52",  x=-80.64, y=312.71, z=3184.73},
  {name="c53",  x=-221.26, y=261.06, z=3142.27},
  {name="c54",  x=-1075.72, y=184.44, z=2926.96},
  {name="c55",  x=-1739.21, y=187.37, z=3003.67},
  {name="c56",  x=-1715.69, y=297.26, z=3135.69},
  {name="c57",  x=-1153.51, y=233.67, z=2954.31},
  {name="c58",  x=-1292.28, y=194.77, z=3058.64},
  {name="c59",  x=-643.26, y=265.53, z=3104.32},
  {name="c60",  x=-1907.59, y=241.24, z=3362.94},
  {name="c61",  x=-1738.32, y=113.25, z=3255.39},
  {name="c62",  x=-1589.29, y=140.60, z=3346.54},
  {name="c63",  x=-1783.71, y=107.54, z=3265.32},
  {name="c64",  x=-1637.58, y=225.40, z=3336.81},
  {name="c65",  x=-1536.05, y=200.86, z=3245.39},
  {name="c66",  x=-1372.44, y=206.13, z=3248.46},
  {name="c67",  x=-912.95, y=111.60, z=3141.22},
  {name="c68",  x=-1447.90, y=156.96, z=3293.87},
  {name="c69",  x=-275.70, y=198.37, z=3268.11},
  {name="c70",  x=-12.75, y=247.37, z=3437.83},
  {name="c71",  x=-341.44, y=220.92, z=3492.96},
  {name="c72",  x=-167.06, y=238.97, z=3905.97},
  {name="c73",  x=-207.19, y=213.16, z=3663.33},
  {name="c74",  x=-253.73, y=255.72, z=3398.62},
  {name="c75",  x=-406.85, y=210.21, z=3567.94},
  {name="c76",  x=-141.59, y=278.86, z=3522.58},
  {name="c77",  x=-361.17, y=220.33, z=3339.97},
  {name="c78",  x=-485.45, y=167.19, z=3322.41},
  {name="c79",  x=-305.54, y=240.65, z=3946.42},
  {name="c80",  x=-692.57, y=281.35, z=3689.21},
  {name="c81",  x=-765.31, y=162.33, z=3378.84},
  {name="c82",  x=-1009.19, y=303.36, z=3813.95},
  {name="c83",  x=-1101.80, y=215.36, z=3643.71},
  {name="c84",  x=-943.04, y=203.61, z=3706.41},
  {name="c85",  x=-1108.57, y=177.47, z=3702.71},
  {name="c86",  x=-1302.30, y=199.59, z=3564.98},
  {name="c87",  x=-2015.72, y=515.53, z=3599.45},
  {name="c88",  x=-1774.80, y=368.43, z=3718.28},
  {name="c89",  x=-1814.20, y=157.52, z=3487.96},
  {name="c90",  x=-1901.50, y=331.04, z=3744.50},
  {name="c91",  x=-1417.24, y=242.53, z=3685.23},
  {name="c92",  x=-1227.52, y=299.06, z=3986.49},
  {name="c93",  x=-1795.78, y=185.72, z=3619.76},
  {name="c94",  x=-819.81, y=141.21, z=3377.66},
  {name="c95",  x=-696.71, y=243.92, z=3531.12},
  {name="c96",  x=-642.58, y=208.92, z=4087.72},
  {name="c108",  x=-1312.82, y=313.99, z=2108.41},
  {name="c109",  x=-1239.73, y=268.28, z=2210.85},
  {name="cs97",  x=-1130.44, y=260.35, z=2524.46},
  {name="cs98",  x=-1946.23, y=224.62, z=3296.12},
  {name="cs99",  x=-1839.42, y=360.46, z=3532.97},
  {name="cs100",  x=-1654.30, y=197.25, z=3462.86},
  {name="cs101",  x=-1280.96, y=192.18, z=3287.37},
  {name="cs102",  x=-1429.89, y=264.97, z=3839.74},
  {name="cs103",  x=-614.19, y=144.76, z=4007.00},
  {name="cs104",  x=-435.99, y=217.25, z=3768.87},
  {name="cs105",  x=-930.53, y=317.40, z=3296.67},
  {name="cs106",  x=-957.78, y=211.74, z=3784.76},
  {name="cs107",  x=-1517.52, y=233.58, z=3107.05},
  {name="cs110",  x=552.88, y=97.86, z=2530.02},
  {name="CST341",  x=-1763.66, y=5.99, z=5539.63},
  {name="CST342",  x=-1482.25, y=100.71, z=5031.71},
  {name="CST343",  x=-1201.59, y=105.64, z=5145.61},
  {name="CST344",  x=-1207.89, y=52.37, z=5276.01},
  {name="CST345",  x=-1176.03, y=-1.77, z=5388.58},
  {name="CST346",  x=-1107.72, y=-1.57, z=5407.85},
  {name="CST347",  x=-1215.10, y=-15.64, z=5474.45},
  {name="CST348",  x=-999.64, y=99.88, z=5655.46},
  {name="CST349",  x=-922.49, y=-244.01, z=5996.11},
  {name="CST3410",  x=-815.06, y=-237.18, z=5862.64},
  {name="CST3411",  x=-834.44, y=-22.19, z=5785.16},
  {name="CST3412",  x=-1852.10, y=19.23, z=5714.23},
  {name="CST3413",  x=-624.68, y=61.59, z=5740.76},
  {name="CST3414",  x=-508.57, y=83.91, z=5663.54},
  {name="CST3415",  x=-406.43, y=134.70, z=5811.09},
  {name="CST3416",  x=-214.65, y=153.69, z=5533.22},
  {name="CST3417",  x=-431.82, y=167.14, z=5563.32},
  {name="CST3418",  x=-422.05, y=-15.44, z=5562.58},
  {name="CST3419",  x=-342.99, y=-184.76, z=5445.79},
  {name="CST3420",  x=-261.16, y=151.81, z=5267.32},
  {name="CST3421",  x=-403.37, y=293.38, z=5334.22},
  {name="CST3422",  x=-507.15, y=247.38, z=5405.72},
  {name="CST3423",  x=-1713.61, y=-1.06, z=5826.87},
  {name="CST3424",  x=-580.86, y=202.08, z=5425.64},
  {name="CST3425",  x=-193.44, y=86.28, z=5140.69},
  {name="CST3426",  x=-249.30, y=236.47, z=5116.28},
  {name="CST3427",  x=-188.61, y=139.49, z=5037.80},
  {name="CST3428",  x=-399.79, y=254.66, z=5162.82},
  {name="CST3429",  x=-150.65, y=40.72, z=4777.85},
  {name="CST3430",  x=-253.96, y=4.39, z=4653.04},
  {name="CST3431",  x=-234.57, y=134.45, z=4531.21},
  {name="CST3432",  x=-108.20, y=260.08, z=4334.58},
  {name="CST3433",  x=-373.67, y=229.64, z=4288.03},
  {name="CST3434",  x=-1494.78, y=8.69, z=5483.43},
  {name="CST3435",  x=-457.52, y=71.02, z=4473.29},
  {name="CST3436",  x=-489.00, y=130.48, z=4600.91},
  {name="CST3437",  x=-543.71, y=228.11, z=4844.93},
  {name="CST3438",  x=-733.45, y=-66.09, z=4428.55},
  {name="CST3439",  x=-800.50, y=6.62, z=4469.98},
  {name="CST3440",  x=-1014.05, y=37.20, z=4561.58},
  {name="CST3441",  x=-1062.04, y=169.11, z=4927.51},
  {name="CST3442",  x=-994.65, y=28.38, z=4907.36},
  {name="CST3443",  x=-830.91, y=194.01, z=4919.04},
  {name="CST3444",  x=-813.40, y=243.12, z=4975.48},
  {name="CST3445",  x=-1414.24, y=-19.87, z=5441.35},
  {name="CST3446",  x=-766.17, y=-44.95, z=4899.96},
  {name="CST3447",  x=-598.94, y=264.12, z=5192.69},
  {name="CST3448",  x=-690.62, y=-845.48, z=5240.12},
  {name="CST3449",  x=-889.08, y=-849.61, z=5197.84},
  {name="CST3450",  x=-855.71, y=-849.61, z=5348.40},
  {name="CST3451",  x=-1034.32, y=154.35, z=5071.63},
  {name="CST3452",  x=-1404.69, y=2.53, z=5370.78},
  {name="CST3453",  x=-1396.59, y=-11.76, z=5603.79},
  {name="CST3454",  x=-1275.57, y=3.97, z=5715.14},
  {name="CST3455",  x=-1226.30, y=51.33, z=5808.37},
  {name="DendroculuDesert-1",  x=-1560.57, y=239.99, z=4154.58},
  {name="DendroculusDesert-2",  x=-1497.02, y=263.16, z=4403.89},
  {name="DendroculusDesert-3",  x=-1485.39, y=31.36, z=4412.07},
  {name="DendroculusDesert-4",  x=-1430.01, y=117.90, z=4768.01},
  {name="DendroculusDesert-5",  x=-1419.10, y=23.32, z=4753.13},
  {name="DendroculusDesert-6",  x=-1424.14, y=15.24, z=4707.10},
  {name="DendroculusDesert-7",  x=-1635.39, y=32.11, z=4527.68},
  {name="DendroculusDesert-8",  x=-1839.67, y=368.10, z=4222.62},
  {name="DendroculusDesert-9",  x=-1936.44, y=276.41, z=4225.15},
  {name="DendroculusDesert-10",  x=-2010.93, y=316.69, z=4114.33},
  {name="DendroculusDesert-11",  x=-2058.80, y=266.87, z=4304.38},
  {name="DendroculusDesert-12",  x=-2036.92, y=88.46, z=4557.41},
  {name="DendroculusDesert-13",  x=-2292.73, y=275.10, z=3943.30},
  {name="DendroculusDesert-14",  x=-2410.42, y=219.15, z=4088.42},
  {name="DendroculusDesert-15",  x=-2450.67, y=262.40, z=4185.66},
  {name="DendroculusDesert-16",  x=-2414.12, y=67.22, z=4269.23},
  {name="DendroculusDesert-17",  x=-2394.15, y=78.80, z=4258.73},
  {name="DendroculusDesert-18",  x=-2386.20, y=76.98, z=4297.23},
  {name="DendroculusDesert-19",  x=-2317.44, y=76.05, z=4323.39},
  {name="DendroculusDesert-20",  x=-2327.58, y=69.62, z=4445.80},
  {name="DendroculusDesert-21",  x=-2376.03, y=187.10, z=4540.22},
  {name="DendroculusDesert-22",  x=-2335.27, y=134.05, z=4669.50},
  {name="DendroculusDesert-23",  x=-2722.37, y=311.59, z=4186.65},
  {name="DendroculusDesert-24",  x=-3007.88, y=14.89, z=4250.09},
  {name="DendroculusDesert-25",  x=-3130.52, y=30.02, z=4302.45},
  {name="DendroculusDesert-26",  x=-3327.49, y=228.48, z=4551.27},
  {name="DendroculusDesert-27",  x=-3327.03, y=231.18, z=4583.75},
  {name="DendroculusDesert-28",  x=-3322.93, y=266.34, z=4616.82},
  {name="DendroculusDesert-29",  x=-3248.82, y=373.90, z=4719.70},
  {name="DendroculusDesert-30",  x=-3002.43, y=282.75, z=4909.36},
  {name="DendroculusDesert-31",  x=-2957.28, y=323.75, z=4760.53},
  {name="DendroculusDesert-32",  x=-2836.42, y=29.59, z=4524.11},
  {name="DendroculusDesert-33",  x=-2716.80, y=242.51, z=4647.83},
  {name="DendroculusDesert-34",  x=-2694.46, y=286.94, z=4752.04},
  {name="DendroculusDesert-35",  x=-2740.22, y=186.53, z=4959.08},
  {name="DendroculusDesert-36",  x=-2787.60, y=223.49, z=5278.35},
  {name="DendroculusDesert-37",  x=-2753.86, y=-29.62, z=5359.70},
  {name="DendroculusDesert-38",  x=-2992.28, y=218.33, z=5293.00},
  {name="DendroculusDesert-39",  x=-2992.77, y=221.23, z=5541.13},
  {name="DendroculusDesert-40",  x=-2829.77, y=98.90, z=5803.43},
  {name="DendroculusDesert-41",  x=-2637.16, y=8.32, z=5680.26},
  {name="DendroculusDesert-42",  x=-2582.90, y=35.68, z=5882.76},
  {name="DendroculusDesert-43",  x=-2673.63, y=218.59, z=5945.35},
  {name="DendroculusDesert-44",  x=-1826.23, y=138.97, z=4881.54},
  {name="DendroculusDesert-45",  x=-2042.37, y=186.78, z=5134.14},
  {name="DendroculusDesert-46",  x=-1922.02, y=136.21, z=5305.23},
  {name="DendroculusDesert-47",  x=-1972.96, y=184.88, z=5441.44},
  {name="DendroculusDesert-48",  x=-1852.64, y=168.11, z=5581.73},
  {name="DendroculusDesert-49",  x=-1940.45, y=150.50, z=5927.24},
  {name="DendroculusDesert-50",  x=-2107.58, y=190.70, z=5972.33},
  {name="DendroculusDesert-51",  x=-2099.71, y=-22.10, z=5815.26},
  {name="DendroculusDesert-52",  x=-2156.49, y=190.76, z=5747.90},
  {name="DendroculusDesert-53",  x=-2365.15, y=-41.13, z=5910.75},
  {name="DendroculusDesert-54",  x=-2324.42, y=188.19, z=5780.60},
  {name="DendroculusDesert-55",  x=-2386.02, y=206.62, z=5770.98},
  {name="DendroculusDesert-56",  x=-2319.14, y=45.62, z=5748.09},
  {name="DendroculusDesert-57",  x=-2192.25, y=17.00, z=5568.62},
  {name="DendroculusDesert-58",  x=-2150.15, y=-17.15, z=5557.81},
  {name="DendroculusDesert-59",  x=-2301.54, y=142.51, z=5004.42},
  {name="DendroculusDesert-60",  x=-2351.27, y=153.13, z=5101.48},
  {name="DendroculusDesert-61",  x=-2422.31, y=134.43, z=5269.15},
  {name="DendroculusDesert-62",  x=-2380.19, y=24.14, z=5304.00},
  {name="DendroculusDesert-63",  x=-2315.67, y=170.52, z=5309.78},
  {name="DendroculusDesert-64",  x=-2380.23, y=67.21, z=5377.96},
  {name="DendroculusDesert-65",  x=-2495.23, y=44.70, z=5298.01},
  {name="DendroculusDesert-66",  x=-2226.91, y=99.84, z=5258.83},
  {name="DendroculusDesert-67",  x=-2308.14, y=201.05, z=5513.42},
  {name="DendroculusDesert-68",  x=-2305.03, y=51.98, z=5568.65},
  {name="DendroculusDesert-69",  x=-2390.51, y=200.53, z=5513.90},
  {name="DendroculusDesert-70",  x=-2348.92, y=336.93, z=5529.52},
}

local function read_idx()
  local f = io.open(PATH, "r")
  if f then
    local s = f:read("*l")
    f:close()
    local n = tonumber(s)
    if n and n >= 1 and n <= #W then return n end
  end
  return 1
end

local function write_idx(n)
  local okw, err = pcall(function()
    local f = io.open(PATH, "w")
    if f then f:write(tostring(n)); f:close() end
  end)
  if not okw then
    show("写入错误: " .. tostring(err))
  end
end

local idx = read_idx()
local wp = W[idx]
local pos = Vector3(wp.x, wp.y, wp.z)
CS.MoleMole.ActorUtils.SetAvatarPos(pos)
show(string.format("TP %d/%d: %s  (X:%.2f Y:%.2f Z:%.2f)  [next-> %d]",
  idx, #W, wp.name, wp.x, wp.y, wp.z, (idx % #W) + 1))
idx = idx + 1
if idx > #W then idx = 1 end
write_idx(idx)